<!DOCTYPE html>
<!-- http://bl.ocks.org/mbostock/1125997
This animation demonstrates the use of transition.transition to create chained transitions. Chained transitions inherit the reference time of the original transition, guaranteeing synchronicity. Furthermore, since initial transitions are created within the context of transition.each the circles are precisely synchronized. -->
<head>
  <meta charset="utf-8">
  <script src="http://d3js.org/d3.v3.min.js"></script>         <!-- Load the d3 library -->
  <link href="../../taste.css" rel="stylesheet" media="screen">      <!-- Taste of D3's CSS; you can get rid of it in your version -->
  <style>
    circle {
      fill: #000;
      stroke: #000;
      stroke-width: 1.5px;
    }
  </style>
</head>
<body>
<h1>Chained Transitions</h1>
<p> Based on Mike Bostock's  <a href="http://bl.ocks.org/mbostock/1125997">http://bl.ocks.org/mbostock/1125997</a>,
mostly tweaked to make it easier for beginners to understand.</p>

<svg width="960" height="500"></svg>        <!-- SVG graphics will go here  -->

<script type="text/javascript">
// Set the parameters
var fromColor = "Purple", toColor = "orange",
  spaceBetweenCircles = 70;

// Create a margin so the circles don't get clipped
var width = 880, height = 420;
var svg = d3.select("svg").append("g")
  .attr("transform", "translate(40, 40)");

// What exactly does this do?
// Looks like and using it to set the circle y plus something else, I think (?)
var y = d3.scale.ordinal()
    .domain(d3.range(50))
    .rangePoints([0, height]);

// Create a scale of colors
var circleColors = d3.scale.linear()
    .domain([10, 0])
    .range([fromColor, toColor])
    .interpolate(d3.interpolateHcl);  //Research interpolation


svg.selectAll("circle")
    .data(y.domain())     // Has an arrayOf 0, 1, 2...
  .enter().append("circle")
    .attr("r", 25)
    .attr("cx", 0)
    .attr("cy", y)
    .style("fill", function(d) { return circleColors(Math.abs(d % 20 - 10)); })
  .transition()
    .duration(2500)
    .delay(function(d) { return d * spaceBetweenCircles; })
    .each(slide);

function slide() {
  var circle = d3.select(this);
  (function repeat() {
    circle = circle.transition()
        .attr("cx", width)
      .transition()
        .attr("cx", 0)
        .each("end", repeat);
  })();
}
</script>
</body>
</html>
